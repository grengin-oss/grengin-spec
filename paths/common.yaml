# Common paths - health, models, files, settings

# Health check
/health:
  get:
    tags:
    - health
    summary: Health check
    description: Comprehensive health check including database and cache status
    operationId: getHealth
    security: []
    responses:
      '200':
        description: Service health status
        content:
          application/json:
            schema:
              $ref: '../openapi.yaml#/components/schemas/HealthResponse'

# AI models
/models:
  get:
    tags:
    - models
    summary: List available models
    description: Get list of available AI models by provider
    operationId: listModels
    security:
    - bearerAuth: []
    responses:
      '200':
        description: List of providers and models
        content:
          application/json:
            schema:
              type: object
              properties:
                providers:
                  type: array
                  items:
                    $ref: '../openapi.yaml#/components/schemas/ProviderInfo'
      '401':
        $ref: '../openapi.yaml#/components/responses/Unauthorized'

# User settings
/settings:
  get:
    tags:
    - settings
    summary: Get user settings
    description: Get current user settings and preferences
    operationId: getSettings
    security:
    - bearerAuth: []
    responses:
      '200':
        description: User settings
        content:
          application/json:
            schema:
              $ref: '../openapi.yaml#/components/schemas/UserSettings'
      '401':
        $ref: '../openapi.yaml#/components/responses/Unauthorized'
  put:
    tags:
    - settings
    summary: Update user settings
    description: Update user settings and preferences
    operationId: updateSettings
    security:
    - bearerAuth: []
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: '../openapi.yaml#/components/schemas/UserSettings'
    responses:
      '200':
        description: Updated settings
        content:
          application/json:
            schema:
              $ref: '../openapi.yaml#/components/schemas/UserSettings'
      '400':
        $ref: '../openapi.yaml#/components/responses/BadRequest'
      '401':
        $ref: '../openapi.yaml#/components/responses/Unauthorized'

# File management
/files:
  post:
    tags:
    - files
    summary: Upload file
    description: Upload a new file (supports PDF, DOCX, TXT, CSV, XLSX, PNG, JPG, WEBP)
    operationId: uploadFile
    security:
    - bearerAuth: []
    requestBody:
      required: true
      content:
        multipart/form-data:
          schema:
            type: object
            required:
            - file
            properties:
              file:
                type: string
                format: binary
              description:
                type: string
    responses:
      '200':
        description: File uploaded successfully
        content:
          application/json:
            schema:
              $ref: '../openapi.yaml#/components/schemas/UserFile'
      '400':
        description: Bad request (invalid file type, too large, etc.)
        content:
          application/json:
            schema:
              $ref: '../openapi.yaml#/components/schemas/Error'
      '401':
        $ref: '../openapi.yaml#/components/responses/Unauthorized'
  get:
    tags:
    - files
    summary: List files
    description: Get paginated list of user files
    operationId: listFiles
    security:
    - bearerAuth: []
    parameters:
    - name: limit
      in: query
      schema:
        type: integer
        default: 20
        minimum: 1
        maximum: 100
    - name: offset
      in: query
      schema:
        type: integer
        default: 0
        minimum: 0
    - name: type
      in: query
      description: Filter by MIME type (case-insensitive)
      schema:
        type: string
    - name: search
      in: query
      description: Search in filename and description
      schema:
        type: string
    - name: sort
      in: query
      schema:
        type: string
        enum:
        - name
        - size
        - created_at
        default: created_at
    - name: order
      in: query
      schema:
        type: string
        enum:
        - asc
        - desc
        default: desc
    responses:
      '200':
        description: Paginated list of files
        content:
          application/json:
            schema:
              $ref: '../openapi.yaml#/components/schemas/PaginatedFiles'
      '401':
        $ref: '../openapi.yaml#/components/responses/Unauthorized'

/files/{file_id}:
  get:
    tags:
    - files
    summary: Get file details
    description: Get details of a specific file
    operationId: getFile
    security:
    - bearerAuth: []
    parameters:
    - $ref: '../openapi.yaml#/components/parameters/FileId'
    responses:
      '200':
        description: File details
        content:
          application/json:
            schema:
              $ref: '../openapi.yaml#/components/schemas/UserFile'
      '401':
        $ref: '../openapi.yaml#/components/responses/Unauthorized'
      '404':
        $ref: '../openapi.yaml#/components/responses/NotFound'
  delete:
    tags:
    - files
    summary: Delete file
    description: Delete a file
    operationId: deleteFile
    security:
    - bearerAuth: []
    parameters:
    - $ref: '../openapi.yaml#/components/parameters/FileId'
    responses:
      '204':
        description: File deleted successfully
      '401':
        $ref: '../openapi.yaml#/components/responses/Unauthorized'
      '404':
        $ref: '../openapi.yaml#/components/responses/NotFound'

/files/{file_id}/download:
  get:
    tags:
    - files
    summary: Download file
    description: Download file content
    operationId: downloadFile
    security:
    - bearerAuth: []
    parameters:
    - $ref: '../openapi.yaml#/components/parameters/FileId'
    responses:
      '200':
        description: File content
        content:
          application/octet-stream:
            schema:
              type: string
              format: binary
      '401':
        $ref: '../openapi.yaml#/components/responses/Unauthorized'
      '404':
        $ref: '../openapi.yaml#/components/responses/NotFound'
