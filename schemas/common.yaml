# Common schemas - errors, health, pagination
Error:
  type: object
  required:
    - detail
  properties:
    detail:
      oneOf:
        - type: string
        - type: object
          properties:
            error:
              type: string
            code:
              type: string
            message:
              type: string
  example:
    detail: Resource not found

ValidationError:
  type: object
  required:
    - detail
  properties:
    detail:
      type: array
      items:
        type: object
        properties:
          loc:
            type: array
            items:
              type: string
          msg:
            type: string
          type:
            type: string

HealthResponse:
  type: object
  required:
    - status
    - timestamp
  properties:
    status:
      type: string
      enum:
        - healthy
        - degraded
        - unhealthy
    timestamp:
      type: string
      format: date-time
    services:
      type: object
      properties:
        database:
          type: string
          enum:
            - up
            - down
        redis:
          type: string
          enum:
            - up
            - down
        llm_providers:
          type: object
          additionalProperties:
            type: string
            enum:
              - up
              - down
    version:
      type: string

# File-related schemas
FileStatus:
  type: string
  enum:
    - uploaded
    - processing
    - ready
    - error

VirusScanStatus:
  type: string
  enum:
    - pending
    - clean
    - infected
    - error

UserFile:
  type: object
  required:
    - id
    - name
    - size
    - type
    - created_at
  properties:
    id:
      type: string
      format: uuid
    name:
      type: string
      description: User-facing filename
    size:
      type: integer
      format: int64
    type:
      type: string
      description: MIME type
    description:
      type:
        - string
        - "null"
    url:
      type: string
      format: uri
    download_url:
      type: string
      format: uri
    created_at:
      type: string
      format: date-time
    updated_at:
      type: string
      format: date-time
    user_id:
      type: string
      format: uuid
      description: ID of the user who uploaded the file
    status:
      $ref: '#/FileStatus'
    metadata:
      type: object
      properties:
        checksum:
          type: string
        virus_scan_status:
          $ref: '#/VirusScanStatus'
        processing_status:
          type: string

PaginatedFiles:
  type: object
  required:
    - files
    - total
    - limit
    - offset
  properties:
    files:
      type: array
      items:
        $ref: '#/UserFile'
    total:
      type: integer
    limit:
      type: integer
    offset:
      type: integer
    sort:
      type: string
    order:
      type: string
      enum:
        - asc
        - desc

# AI Engine/Model schemas - shared across chat, public, and admin APIs

# AI Engine identifier
AIEngine:
  type: string
  description: AI engine identifier (e.g., openai, anthropic, groq, or any custom provider)

# Parameter definition for AI models
AIModelParameter:
  type: object
  required:
    - name
    - type
  properties:
    name:
      type: string
      description: Parameter name (e.g., temperature, max_tokens)
    type:
      type: string
      enum: [number, integer, boolean, string]
    default:
      description: Default value for the parameter
    min:
      type: number
      description: Minimum value (for numeric types)
    max:
      type: number
      description: Maximum value (for numeric types)
    description:
      type: string

# Model info for /models endpoint and chat APIs
ModelInfo:
  type: object
  required:
    - key
    - name
  properties:
    key:
      type: string
      description: Model identifier used with APIs (e.g., gpt-4.1, claude-sonnet-4-20250514)
    name:
      type: string
      description: Human-readable name for the model
    engine:
      $ref: '#/AIEngine'
    comment:
      type:
        - string
        - "null"
      description: Comment displayed to user when model is selected
    icon:
      type:
        - string
        - "null"
      description: Optional SVG icon (overrides engine default icon)
    context_window:
      type:
        - integer
        - "null"
    max_output_tokens:
      type:
        - integer
        - "null"
    supports_streaming:
      type: boolean
    supports_tools:
      type: boolean
    supports_vision:
      type: boolean
      description: Whether the model supports image inputs
    supports_pdf_native:
      type: boolean
      description: Whether the model supports native PDF processing
    supports_web_search:
      type: boolean
      description: Whether the model supports web search
    max_images:
      type:
        - integer
        - "null"
      description: Maximum number of images supported per request
    pricing:
      type:
        - object
        - "null"
      properties:
        input:
          type: number
          format: float
          description: Price per 1M input tokens in USD
        output:
          type: number
          format: float
          description: Price per 1M output tokens in USD

# Provider info with nested models for /models endpoint
ProviderInfo:
  type: object
  required:
    - key
    - name
    - models
  properties:
    key:
      type: string
      description: Provider identifier (same as AIEngine)
    name:
      type: string
      description: Human-readable provider name
    icon:
      type:
        - string
        - "null"
    status:
      type: string
      enum:
        - active
        - degraded
        - unavailable
    models:
      type: array
      items:
        $ref: '#/ModelInfo'

# Settings schemas
ModelSelection:
  type: object
  required:
    - model_name
    - provider
  properties:
    model_name:
      type: string
    provider:
      type: string

ModelSettings:
  type: object
  properties:
    tool_models:
      type: object
      additionalProperties:
        $ref: '#/ModelSelection'

UserSettings:
  type: object
  properties:
    models:
      $ref: '#/ModelSettings'
    default_model:
      type: string
    default_provider:
      type: string
    theme:
      type: string
      enum:
        - light
        - dark
        - system
    language:
      type: string
      default: en

# Branding schemas
Branding:
  type: object
  description: Platform branding configuration
  properties:
    name:
      type: string
      description: Platform name (white-label support)
      default: 'Grengin'
      maxLength: 100
    logo_url:
      type:
        - string
        - "null"
      format: uri
    color_primary:
      type: string
      pattern: '^#[0-9A-Fa-f]{6}$'
      default: '#4079c5'
    color_accent:
      type: string
      pattern: '^#[0-9A-Fa-f]{6}$'
      default: '#2d906b'
    font_family:
      type: string
      default: 'Coustard'
      maxLength: 50
  required:
    - name
    - color_primary
    - color_accent
    - font_family

BrandingUpdate:
  type: object
  description: Branding update (all fields optional)
  properties:
    name:
      type: string
      maxLength: 100
    logo_url:
      type:
        - string
        - "null"
      format: uri
    color_primary:
      type: string
      pattern: '^#[0-9A-Fa-f]{6}$'
    color_accent:
      type: string
      pattern: '^#[0-9A-Fa-f]{6}$'
    font_family:
      type: string
      maxLength: 50
